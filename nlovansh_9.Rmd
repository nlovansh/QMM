---
title: "QMM_Module 9_Goal Programming"
author: "Nidhi Lovanshi"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
***Question 1***

Define y1+ and y1-, respectively, as the amount over (if any) and the amount under (if any) the employment level goal. Define y2+ and y2- in the same way for the goal regarding earnings next year. Define x1, x2, and x3 as the production rates of Products 1, 2, and 3,respectively. With these definitions, use the goal programming technique to express y1+,y1- , y2+ and y2- algebraically in terms of x1, x2, and x3. Also express P in terms of x1, x2,and x3.


Defining the variables:  

x1 be production rates of Products 1  
x2 be production rates of Products 2  
x3 be production rates of Products 3  
y1_plus be amount over the employment level goal  
y1_minus be amount under the employment level goal  
y2_plus be amount over the earnings goal for next year  
y2_minus be amount under the earnings goal for next year  


Constraints:

1) Employment Level Goal:  
Total employment generated by the products is given by:

  6x1 + 4x2 + 5x3 + y1_plus - y1_minus = 50

2) Earnings Goal:  
Total earnings generated by the products is given by:

  8x1 + 7x2 + 5x3 + y2_plus - y2_minus >=75


Total Profit P : 

P = 20x1 + 15x2 + 25x3


***Question 2***  

Express managementâ€™s objective function in terms of x1, x2, x3, y1+, y1- , y2+ and y2-


Expressing management's objective function:

Maximize Z = P - 6C - 3D

where:  
C = y1_plus + y1_minus (total change in employment level)  
D = y2_minus (decrease in earnings)

Substituting into above function:

Maximize Z = (20x1 + 15x2 + 25x3) - 6(y1_plus + y1_minus) - 3(y2_minus)

***Question 3***  

Formulate and solve the linear programming model. What are your findings?


Objective function:  
Maximize Z = 20x1 + 15x2 + 25x3 - 6y1_plus - 6y1_minus - 3y2_minus

Subject to constraints:  
6x1 + 4x2 + 5x3 + y1_plus - y1_minus = 50 (Employment level goal)  
8x1 + 7x2 + 5x3 + y2_plus - y2_minus >= 75 (Earnings goal)  
x1, x2, x3, y1_plus, y1_minus, y2_plus, y2_minus >= 0 (Non-negativity constraints)  


Solving now with lpSolveAPI

***Load Package***
```{r}
library(lpSolveAPI)
```

***Create a linear programming model***
```{r}
# Creating a model with 7 variables
# Variables: x1, x2, x3, y1_plus, y1_minus, y2_plus, y2_minus
lp_model <- make.lp(0, 7)
```

***Objective function coefficients***
```{r}
# Set the objective function coefficients
# Objective: Maximize Z = 20x1 + 15x2 + 25x3 - 6(y1_plus + y1_minus) - 3y2_minus
set.objfn(lp_model, c(20, 15, 25, -6, -6, 0, -3))

```

***Constraints***
```{r}
# Employment level constraint: 6x1 + 4x2 + 5x3 + y1_plus - y1_minus = 50
add.constraint(lp_model, c(6, 4, 5, 1, -1, 0, 0), "=", 50)

# Earnings constraint: 8x1 + 7x2 + 5x3 + y2_plus - y2_minus >=75
add.constraint(lp_model, c(8, 7, 5, 0, 0, 1, -1), ">=", 75)

```

***Solving linear programming model***
```{r}
# Set the problem to maximize
lp.control(lp_model, sense = "max")

# Solve the model
solve(lp_model)
```

***Objective and Decision variables value***
```{r}
# Get the objective value
objective_value <- get.objective(lp_model)

# Get the values of decision variables
variables <- get.variables(lp_model)
```

```{r}
# Print the results
cat(
  "Optimal Solution Found:\n",
  "Objective Value (Z): ", objective_value, "\n\n",
  "Production rates:\n",
  "Product 1 (x1): ", variables[1], "\n",
  "Product 2 (x2): ", variables[2], "\n",
  "Product 3 (x3): ", variables[3], "\n\n",
  "Employment level deviation:\n",
  "Over (y1_plus): ", variables[4], "\n",
  "Under (y1_minus): ", variables[5], "\n\n",
  "Earnings deviation:\n",
  "Over (y2_plus): ", variables[6], "\n",
  "Under (y2_minus): ", variables[7], "\n"
)
```

Thus,
Maximum profit is $250 million dollars.  

Product 1 produces 0 units    
Product 2 produces 0 units   
Product 3 is produces at a rate of 10 units  

Employment level deviation is 0 meaning there is no deviation for y1_plus and y1_minus, employment level is stable.  

Earnings deviation for y2_plus is $25 million dollar meaning there is excess of $25 million

```{r}

total_profit <- 20*variables[1] + 15*variables[2] + 25*variables[3]
actual_employment <- 6*variables[1] + 4*variables[2] + 5*variables[3]
actual_earnings <- 8*variables[1] + 7*variables[2] + 5*variables[3]

cat(
  "Total profit: ", total_profit, " million dollars\n",
  "Actual employment level: ", actual_employment, " hundred employees\n",
  "Actual earnings next year: ", actual_earnings, " million dollars\n"
)
```
The overall profit achieved through the optimal production strategy amounts to $250 million.
The company sustains a consistent workforce, currently employing 50 hundred employees.
Furthermore, the anticipated earnings for the upcoming year is projected to be $50 million.







